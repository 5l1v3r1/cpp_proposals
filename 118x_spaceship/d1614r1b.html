<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="mpark/wg21" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2019-06-12" />
  <title>The Mothership has Landed</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
      #refs p{padding-left: 32px; text-indent: -32px;}
  </style>
  <style>
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f6f8fa; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { } /* Normal */
code span.al { color: #ff0000; } /* Alert */
code span.an { } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #9f6807; } /* BaseN */
code span.bu { color: #9f6807; } /* BuiltIn */
code span.cf { color: #00607c; } /* ControlFlow */
code span.ch { color: #9f6807; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; font-style: italic; } /* Comment */
code span.cv { color: #008000; font-style: italic; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dt { color: #00607c; } /* DataType */
code span.dv { color: #9f6807; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #9f6807; } /* Float */
code span.fu { } /* Function */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #00607c; } /* Keyword */
code span.op { color: #af1915; } /* Operator */
code span.ot { } /* Other */
code span.pp { color: #6f4e37; } /* Preprocessor */
code span.re { } /* RegionMarker */
code span.sc { color: #9f6807; } /* SpecialChar */
code span.ss { color: #9f6807; } /* SpecialString */
code span.st { color: #9f6807; } /* String */
code span.va { } /* Variable */
code span.vs { color: #9f6807; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
code.diff span.va {color: #006e28}
code.diff span.st {color: #bf0303}
  </style>
  <style type="text/css">
body {
margin: 5em;
font-family: serif;

hyphens: auto;
line-height: 1.35;
}
div.wrapper {
max-width: 60em;
margin: auto;
}
ul {
list-style-type: none;
padding-left: 2em;
margin-top: -0.2em;
margin-bottom: -0.2em;
}
a { text-decoration: none; }
a.hidden_link {
text-decoration: none;
color: inherit;
}
li {
margin-top: 0.6em;
margin-bottom: 0.6em;
}
h1 { line-height: 1; }
h2 { line-height: 1; }
h3 { line-height: 1; }
h4 { line-height: 1; }
ul > li:before {
content: "\2014";
position: absolute;
margin-left: -1.5em;
}
:target { background-color: #C9FBC9; }
:target .codeblock { background-color: #C9FBC9; }
:target ul { background-color: #C9FBC9; }
.abbr_ref { float: right; }
.folded_abbr_ref { float: right; }
:target .folded_abbr_ref { display: none; }
:target .unfolded_abbr_ref { float: right; display: inherit; }
.unfolded_abbr_ref { display: none; }
.secnum { display: inline-block; min-width: 35pt; }
.header-section-number { display: inline-block; min-width: 35pt; }
.annexnum { display: block; }
div.sourceLinkParent {
float: right;
}
a.sourceLink {
position: absolute;
opacity: 0;
margin-left: 10pt;
}
a.sourceLink:hover {
opacity: 1;
}
a.itemDeclLink {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
opacity: 0;
}
a.itemDeclLink:hover { opacity: 1; }
div.marginalizedparent {
position: relative;
left: -5em;
}
li > div.marginalizedparent { left: -7em; }
li > ul > li > div.marginalizedparent { left: -9em; }
li > ul > li > ul > li > div.marginalizedparent { left: -11em; }
li > ul > li > ul > li > ul > li > div.marginalizedparent { left: -13em; }
div.footnoteNumberParent {
position: relative;
left: -4.7em;
}
a.marginalized {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
}
a.enumerated_item_num {
position: relative;
left: -3.5em;
display: inline-block;
margin-right: -3em;
text-align: right;
width: 3em;
}
div.para { margin-bottom: 0.6em; margin-top: 0.6em; text-align: justify; }
div.section { text-align: justify; }
div.sentence { display: inline; }
span.indexparent {
display: inline;
position: relative;
float: right;
right: -1em;
}
a.index {
position: absolute;
display: none;
}
a.index:before { content: "⟵"; }

a.index:target {
display: inline;
}
.indexitems {
margin-left: 2em;
text-indent: -2em;
}
div.itemdescr {
margin-left: 3em;
}
.bnf {
font-family: serif;
margin-left: 40pt;
margin-top: 0.5em;
margin-bottom: 0.5em;
}
.ncbnf {
font-family: serif;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
}
.ncsimplebnf {
font-family: serif;
font-style: italic;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
background: inherit; 
}
span.textnormal {
font-style: normal;
font-family: serif;
white-space: normal;
display: inline-block;
}
span.rlap {
display: inline-block;
width: 0px;
}
span.descr { font-style: normal; font-family: serif; }
span.grammarterm { font-style: italic; }
span.term { font-style: italic; }
span.terminal { font-family: monospace; font-style: normal; }
span.nonterminal { font-style: italic; }
span.tcode { font-family: monospace; font-style: normal; }
span.textbf { font-weight: bold; }
span.textsc { font-variant: small-caps; }
a.nontermdef { font-style: italic; font-family: serif; }
span.emph { font-style: italic; }
span.techterm { font-style: italic; }
span.mathit { font-style: italic; }
span.mathsf { font-family: sans-serif; }
span.mathrm { font-family: serif; font-style: normal; }
span.textrm { font-family: serif; }
span.textsl { font-style: italic; }
span.mathtt { font-family: monospace; font-style: normal; }
span.mbox { font-family: serif; font-style: normal; }
span.ungap { display: inline-block; width: 2pt; }
span.textit { font-style: italic; }
span.texttt { font-family: monospace; }
span.tcode_in_codeblock { font-family: monospace; font-style: normal; }
span.phantom { color: white; }

span.math { font-style: normal; }
span.mathblock {
display: block;
margin-left: auto;
margin-right: auto;
margin-top: 1.2em;
margin-bottom: 1.2em;
text-align: center;
}
span.mathalpha {
font-style: italic;
}
span.synopsis {
font-weight: bold;
margin-top: 0.5em;
display: block;
}
span.definition {
font-weight: bold;
display: block;
}
.codeblock {
margin-left: 1.2em;
line-height: 127%;
}
.outputblock {
margin-left: 1.2em;
line-height: 127%;
}
div.itemdecl {
margin-top: 2ex;
}
code.itemdeclcode {
white-space: pre;
display: block;
}
span.textsuperscript {
vertical-align: super;
font-size: smaller;
line-height: 0;
}
.footnotenum { vertical-align: super; font-size: smaller; line-height: 0; }
.footnote {
font-size: small;
margin-left: 2em;
margin-right: 2em;
margin-top: 0.6em;
margin-bottom: 0.6em;
}
div.minipage {
display: inline-block;
margin-right: 3em;
}
div.numberedTable {
text-align: center;
margin: 2em;
}
div.figure {
text-align: center;
margin: 2em;
}
table {
border: 1px solid black;
border-collapse: collapse;
margin-left: auto;
margin-right: auto;
margin-top: 0.8em;
text-align: left;
hyphens: none; 
}
td, th {
padding-left: 1em;
padding-right: 1em;
vertical-align: top;
}
td.empty {
padding: 0px;
padding-left: 1px;
}
td.left {
text-align: left;
}
td.right {
text-align: right;
}
td.center {
text-align: center;
}
td.justify {
text-align: justify;
}
td.border {
border-left: 1px solid black;
}
tr.rowsep, td.cline {
border-top: 1px solid black;
}
tr.even, tr.odd {
border-bottom: 1px solid black;
}
tr.capsep {
border-top: 3px solid black;
border-top-style: double;
}
tr.header {
border-bottom: 3px solid black;
border-bottom-style: double;
}
th {
border-bottom: 1px solid black;
}
span.centry {
font-weight: bold;
}
div.table {
display: block;
margin-left: auto;
margin-right: auto;
text-align: center;
width: 90%;
}
span.indented {
display: block;
margin-left: 2em;
margin-bottom: 1em;
margin-top: 1em;
}
ol.enumeratea { list-style-type: none; background: inherit; }
ol.enumerate { list-style-type: none; background: inherit; }
</style>
  <style type="text/css">a {
color : #4183C4;
text-decoration: underline;
}
a.marginalized {
text-decoration: none;
}
a.self-link {
position: absolute;
left: calc(-1 * (3.5rem - 26px));
width: calc(3.5rem - 26px);
bottom: 1px;
text-align: center;
border: none;
transition: opacity .2s;
opacity: .5;
text-decoration: none;
}
a.self-link:hover {
opacity: 1;
}
a.self-link::before {
content: "§";
}
h1#toctitle {
border-bottom: 1px solid #cccccc;
}
#TOC li {
margin-top: 1px;
margin-bottom: 1px;
}
#TOC ul>li:before { display: none; }
h3.subtitle { margin-top: -15px; }
h1:target { background-color: transparent; }
h2:target { background-color: transparent; }
h3:target { background-color: transparent; }
h4:target { background-color: transparent; }
h5:target { background-color: transparent; }
h6:target { background-color: transparent; }
h1,h2,h3,h4,h5,h6 { position: relative; }
code span.co { font-family: monospace; }
table tr {
background-color: white;
}
table tr:nth-child(2n) {
background-color: #f6f8fa;
}
#title-block-header > table tr:nth-child(2n) {
background-color: white;
}
td > div.sourceCode {
background-color: inherit;
}
table {
border-collapse: collapse;
}
table td, table th {
border: 1px solid #cccccc;
}
table th {
border-bottom: 1px solid black;
}
table tr:first-child th {
border-top: 0;
}
table tr:last-child td {
border-bottom: 0;
}
table tr td:first-child,
table tr th:first-child {
border-left: 0;
}
table tr td:last-child,
table tr th:last-child {
border-right: 0;
}
table tbody tr:first-child td {
border-top: 1px solid black;
}
#title-block-header td { border: 0; }
@media all {
body {
margin: 2em;
}
}
@media screen and (min-width: 480px) {
body {
margin: 5em;
}
}
</style>
  <link href="data:image/vnd.microsoft.icon;base64,AAABAAIAEBAAAAEAIABoBAAAJgAAACAgAAABACAAqBAAAI4EAAAoAAAAEAAAACAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAVoJEAN6CRADegkQAWIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wCCRAAAgkQAAIJEAACCRAAsgkQAvoJEAP+CRAD/gkQA/4JEAP+CRADAgkQALoJEAACCRAAAgkQAAP///wD///8AgkQAAIJEABSCRACSgkQA/IJEAP99PQD/dzMA/3czAP99PQD/gkQA/4JEAPyCRACUgkQAFIJEAAD///8A////AHw+AFiBQwDqgkQA/4BBAP9/PxP/uZd6/9rJtf/bybX/upd7/39AFP+AQQD/gkQA/4FDAOqAQgBc////AP///wDKklv4jlEa/3o7AP+PWC//8+3o///////////////////////z7un/kFox/35AAP+GRwD/mVYA+v///wD///8A0Zpk+NmibP+0d0T/8evj///////+/fv/1sKz/9bCs//9/fr//////+/m2/+NRwL/nloA/5xYAPj///8A////ANKaZPjRmGH/5cKh////////////k149/3UwAP91MQD/lmQ//86rhv+USg3/m1YA/5hSAP+bVgD4////AP///wDSmmT4zpJY/+/bx///////8+TV/8mLT/+TVx//gkIA/5lVAP+VTAD/x6B//7aEVv/JpH7/s39J+P///wD///8A0ppk+M6SWP/u2sf///////Pj1f/Nj1T/2KFs/8mOUv+eWhD/lEsA/8aee/+0glT/x6F7/7J8Rvj///8A////ANKaZPjRmGH/48Cf///////+/v7/2qt//82PVP/OkFX/37KJ/86siv+USg7/mVQA/5hRAP+bVgD4////AP///wDSmmT40ppk/9CVXP/69O////////7+/v/x4M//8d/P//7+/f//////9u7n/6tnJf+XUgD/nFgA+P///wD///8A0ppk+NKaZP/RmWL/1qNy//r07///////////////////////+vXw/9akdP/Wnmn/y5FY/6JfFvj///8A////ANKaZFTSmmTo0ppk/9GYYv/Ql1//5cWm//Hg0P/x4ND/5cWm/9GXYP/RmGH/0ppk/9KaZOjVnmpY////AP///wDSmmQA0ppkEtKaZI7SmmT60ppk/9CWX//OkVb/zpFW/9CWX//SmmT/0ppk/NKaZJDSmmQS0ppkAP///wD///8A0ppkANKaZADSmmQA0ppkKtKaZLrSmmT/0ppk/9KaZP/SmmT/0ppkvNKaZCrSmmQA0ppkANKaZAD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkUtKaZNzSmmTc0ppkVNKaZADSmmQA0ppkANKaZADSmmQA////AP5/AAD4HwAA4AcAAMADAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAMADAADgBwAA+B8AAP5/AAAoAAAAIAAAAEAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAyCRACMgkQA6oJEAOqCRACQgkQAEIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRABigkQA5oJEAP+CRAD/gkQA/4JEAP+CRADqgkQAZoJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAA4gkQAwoJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQAxIJEADyCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAP///wD///8A////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAWgkQAmIJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAJyCRAAYgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAdIJEAPCCRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAPSCRAB4gkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQASoJEANKCRAD/gkQA/4JEAP+CRAD/g0YA/39AAP9zLgD/bSQA/2shAP9rIQD/bSQA/3MuAP9/PwD/g0YA/4JEAP+CRAD/gkQA/4JEAP+CRADUgkQAToJEAACCRAAAgkQAAP///wD///8A////AP///wB+PwAAgkUAIoJEAKiCRAD/gkQA/4JEAP+CRAD/hEcA/4BBAP9sIwD/dTAA/5RfKv+viF7/vp56/76ee/+wiF7/lWAr/3YxAP9sIwD/f0AA/4RHAP+CRAD/gkQA/4JEAP+CRAD/gkQArIJEACaBQwAA////AP///wD///8A////AIBCAEBzNAD6f0EA/4NFAP+CRAD/gkQA/4VIAP92MwD/bSUA/6N1Tv/ezsL/////////////////////////////////38/D/6V3Uv9uJgD/dTEA/4VJAP+CRAD/gkQA/4JEAP+BQwD/fUAA/4FDAEj///8A////AP///wD///8AzJRd5qBlKf91NgD/dDUA/4JEAP+FSQD/cy4A/3YyAP/PuKP//////////////////////////////////////////////////////9K7qP94NQD/ciwA/4VJAP+CRAD/fkEA/35BAP+LSwD/mlYA6v///wD///8A////AP///wDdpnL/4qx3/8KJUv+PUhf/cTMA/3AsAP90LgD/4dK+/////////////////////////////////////////////////////////////////+TYxf91MAD/dTIA/31CAP+GRwD/llQA/6FcAP+gWwD8////AP///wD///8A////ANGZY/LSm2X/4ap3/92mcP+wdT3/byQA/8mwj////////////////////////////////////////////////////////////////////////////+LYxv9zLgP/jUoA/59bAP+hXAD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/RmWL/1p9q/9ubXv/XqXj////////////////////////////7+fD/vZyG/6BxS/+gcUr/vJuE//r37f//////////////////////3MOr/5dQBf+dVQD/nVkA/5xYAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmWP/yohJ//jo2P//////////////////////4NTG/4JDFf9lGAD/bSQA/20kAP9kGAD/fz8S/+Xb0f//////5NG9/6txN/+LOgD/m1QA/51aAP+cWAD/m1cA/5xYAP+cWADy////AP///wD///8A////ANKaZPLSmmT/0ppk/8+TWf/Unmv//v37//////////////////////+TWRr/VwsA/35AAP+ERgD/g0UA/4JGAP9lHgD/kFga/8KXX/+TRwD/jT4A/49CAP+VTQD/n10A/5xYAP+OQQD/lk4A/55cAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/y4tO/92yiP//////////////////////8NnE/8eCQP+rcTT/ez0A/3IyAP98PgD/gEMA/5FSAP+USwD/jj8A/5lUAP+JNwD/yqV2/694Mf+HNQD/jkAA/82rf/+laBj/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/LiUr/4byY///////////////////////gupX/0I5P/+Wuev/Lklz/l1sj/308AP+QSwD/ol0A/59aAP+aVQD/k0oA/8yoh///////+fXv/6pwO//Lp3v///////Pr4f+oay7y////AP///wD///8A////ANKaZPLSmmT/0ppk/8uJSv/hvJj//////////////////////+G7l//Jhkb/0ppk/96nc//fqXX/x4xO/6dkFP+QSQD/llEA/5xXAP+USgD/yaOA///////38uv/qG05/8ijdv//////8efb/6ZpLPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/zIxO/9yxh///////////////////////7dbA/8iEQf/Sm2X/0Zlj/9ScZv/eqHf/2KJv/7yAQf+XTgD/iToA/5lSAP+JNgD/yKFv/611LP+HNQD/jT8A/8qmeP+kZRT/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/Pk1n/1J5q//78+//////////////////+/fv/1aFv/8iEQv/Tm2b/0ppl/9GZY//Wn2z/1pZc/9eldf/Bl2b/kUcA/4w9AP+OQAD/lUwA/59eAP+cWQD/jT8A/5ZOAP+eXADy////AP///wD///8A////ANKaZPLSmmT/0ppk/9KZY//KiEn/8d/P///////////////////////47+f/05tm/8iCP//KiEj/yohJ/8eCP//RmGH//vfy///////n1sP/rXQ7/4k4AP+TTAD/nVoA/5xYAP+cVwD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/0ptl/8uLTf/aq37////////////////////////////+/fz/6c2y/961jv/etY7/6Myx//78+v//////////////////////3MWv/5xXD/+ORAD/mFQA/51ZAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmmT/0ppk/8mFRP/s1b//////////////////////////////////////////////////////////////////////////////+PD/0JFU/7NzMv+WUQD/kUsA/5tXAP+dWQDy////AP///wD///8A////ANKaZP/SmmT/0ppk/9KaZP/Sm2X/z5NZ/8yMT//z5NX/////////////////////////////////////////////////////////////////9Ofa/8yNUP/UmGH/36p5/8yTWv+qaSD/kksA/5ROAPz///8A////AP///wD///8A0ppk5NKaZP/SmmT/0ppk/9KaZP/TnGf/zY9T/82OUv/t1sD//////////////////////////////////////////////////////+7Yw//OkFX/zI5R/9OcZ//SmmP/26V0/9ymdf/BhUf/ol8R6P///wD///8A////AP///wDSmmQ80ppk9tKaZP/SmmT/0ppk/9KaZP/TnGj/zpFW/8qJSv/dson/8uHS//////////////////////////////////Lj0//etIv/y4lL/86QVf/TnGj/0ppk/9KaZP/RmWP/05xn/9ymdfjUnWdC////AP///wD///8A////ANKaZADSmmQc0ppkotKaZP/SmmT/0ppk/9KaZP/Tm2b/0Zli/8qJSf/NjlH/16Z3/+G8mP/myKr/5siq/+G8mP/Xp3f/zY5S/8qISf/RmGH/05tm/9KaZP/SmmT/0ppk/9KaZP/SmmSm0pljINWdaQD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkQtKaZMrSmmT/0ppk/9KaZP/SmmT/0ptl/9GYYf/Nj1P/y4lL/8qISP/KiEj/y4lK/82PU//RmGH/0ptl/9KaZP/SmmT/0ppk/9KaZP/SmmTO0ppkRtKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZGzSmmTu0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmTw0ppkcNKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZBLSmmSQ0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppklNKaZBTSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQy0ppkutKaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppkvtKaZDbSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkXNKaZODSmmT/0ppk/9KaZP/SmmT/0ppk5NKaZGDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkBtKaZIbSmmTo0ppk6tKaZIrSmmQK0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP/8P///+B///+AH//+AAf//AAD//AAAP/AAAA/gAAAHwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA+AAAAfwAAAP/AAAP/8AAP//gAH//+AH///4H////D//" rel="icon" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  
</head>
<body>
<div class="wrapper">
<header id="title-block-header">
<h1 class="title" style="text-align:center">The Mothership has Landed</h1>
<h3 class="subtitle" style="text-align:center">Adding <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code> to the Library</h3>

<table style="border:none;float:right">
  <tr>
    <td>Document #: </td>
    <td>D1614R1</td>
  </tr>
  <tr>
    <td>Date: </td>
    <td>2019-06-12</td>
  </tr>
  <tr>
    <td style="vertical-align:top">Project: </td>
    <td>Programming Language C++<br>
      LWG<br>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top">Reply-to: </td>
    <td>
      Barry Revzin<br>&lt;<a href="mailto:barry.revzin@gmail.com" class="email">barry.revzin@gmail.com</a>&gt;<br>
    </td>
  </tr>
</table>

</header>
<div style="clear:both">
<div id="TOC" role="doc-toc">
<h1 id="toctitle">Contents</h1>
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> <span></span>Introduction</a></li>
<li><a href="#friendship"><span class="toc-section-number">2</span> <span></span>Friendship</a><ul>
<li><a href="#was-well-formed-now-ill-formed"><span class="toc-section-number">2.1</span> <span></span>Was well-formed, now ill-formed</a></li>
<li><a href="#was-ill-formed-now-well-formed"><span class="toc-section-number">2.2</span> <span></span>Was ill-formed, now well-formed</a></li>
<li><a href="#alternatives"><span class="toc-section-number">2.3</span> <span></span>Alternatives</a></li>
<li><a href="#proposed-direction"><span class="toc-section-number">2.4</span> <span></span>Proposed Direction</a></li>
</ul></li>
<li><a href="#acknowledgements"><span class="toc-section-number">3</span> <span></span>Acknowledgements</a></li>
<li><a href="#wording"><span class="toc-section-number">4</span> <span></span>Wording</a><ul>
<li><a href="#clause-16-library-introduction"><span class="toc-section-number">4.1</span> <span></span>Clause 16: Library Introduction</a></li>
<li><a href="#clause-17-language-support-library"><span class="toc-section-number">4.2</span> <span></span>Clause 17: Language support library</a></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">5</span> <span></span>References</a></li>
</ul>
</div>
<h1 id="introduction" style="border-bottom:1px solid #cccccc"><span class="header-section-number">1</span> <a href="#introduction" class="self-link"></a>Introduction</h1>
<p>The work of integrating <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=&gt;</span></code> into the library has been performed by multiple different papers, each addressing a different aspect of the integration. In the interest of streamlining review by the Library Working Group, the wording has been combined into a single paper. This is that paper.</p>
<p>In San Diego and Kona, several papers were approved by LEWG adding functionality to the library related to comparisons. What follows is the list of those papers, in alphabetical order, with a brief description of what those papers are. The complete motivation and design rationale for each can be found within the papers themselves.</p>
<ul>
<li><span class="citation" data-cites="P0790R2">[<a href="#ref-P0790R2" role="doc-biblioref">P0790R2</a>]</span> - adding <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=&gt;</span></code> to the standard library types whose behavior is not dependent on a template parameter.</li>
<li><span class="citation" data-cites="P0891R2">[<a href="#ref-P0891R2" role="doc-biblioref">P0891R2</a>]</span> - making the <code class="sourceCode cpp">XXX_order</code> algorithms customization points and introducing <code class="sourceCode cpp">compare_XXX_order_fallback</code> algorithms that preferentially invoke the former algorithm and fallback to synthesizing an ordering from <code class="sourceCode cpp"><span class="op">==</span></code> and <code class="sourceCode cpp"><span class="op">&lt;</span></code> (using the rules from <span class="citation" data-cites="P1186R1">[<a href="#ref-P1186R1" role="doc-biblioref">P1186R1</a>]</span>).</li>
<li><span class="citation" data-cites="P1154R1">[<a href="#ref-P1154R1" role="doc-biblioref">P1154R1</a>]</span> - adding the type trait <code class="sourceCode cpp">has_strong_structural_equality<span class="op">&lt;</span>T<span class="op">&gt;</span></code> (useful to check if a type can be used as a non-type template parameter).</li>
<li><span class="citation" data-cites="P1188R0">[<a href="#ref-P1188R0" role="doc-biblioref">P1188R0</a>]</span> - adding the type trait <code class="sourceCode cpp">compare_three_way_result<span class="op">&lt;</span>T<span class="op">&gt;</span></code>, the concepts <code class="sourceCode cpp">ThreeWayComparable<span class="op">&lt;</span>T<span class="op">&gt;</span></code> and <code class="sourceCode cpp">ThreeWayComparableWith<span class="op">&lt;</span>T,U<span class="op">&gt;</span></code>, removing the algorithm <code class="sourceCode cpp">compare_3way</code> and replacing it with a function comparison object <code class="sourceCode cpp">compare_three_way</code> (i.e. the <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code> version of <code class="sourceCode cpp">std<span class="op">::</span>ranges<span class="op">::</span>less</code>).</li>
<li><span class="citation" data-cites="P1189R0">[<a href="#ref-P1189R0" role="doc-biblioref">P1189R0</a>]</span> - adding <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=&gt;</span></code> to the standard library types whose behavior is dependent on a template parameter, removing those equality operators made redundant by <span class="citation" data-cites="P1185R2">[<a href="#ref-P1185R2" role="doc-biblioref">P1185R2</a>]</span> and defaulting <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> where appropriate.</li>
<li><span class="citation" data-cites="P1191R0">[<a href="#ref-P1191R0" role="doc-biblioref">P1191R0</a>]</span> - adding equality to several previously incomparable standard library types.</li>
<li><span class="citation" data-cites="P1295R0">[<a href="#ref-P1295R0" role="doc-biblioref">P1295R0</a>]</span> - adding equality and <code class="sourceCode cpp">common_type</code> for the comparison categories.</li>
<li><span class="citation" data-cites="P1380R1">[<a href="#ref-P1380R1" role="doc-biblioref">P1380R1</a>]</span> - extending the floating point customization points for <code class="sourceCode cpp">strong_order</code> and <code class="sourceCode cpp">weak_order</code>.</li>
</ul>
<h1 id="friendship" style="border-bottom:1px solid #cccccc"><span class="header-section-number">2</span> <a href="#friendship" class="self-link"></a>Friendship</h1>
<p>LEWG’s unanimous preference was that the new <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=&gt;</span></code>s be declared as hidden friends. It would follow therefore that we would move the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code>s to be declared the same way as well, since it would be pretty odd if the two different comparison operators had different semantics.</p>
<p>However, a few issues have come up with this approach that are worth presenting clearly here.</p>
<h2 id="was-well-formed-now-ill-formed"><span class="header-section-number">2.1</span> <a href="#was-well-formed-now-ill-formed" class="self-link"></a>Was well-formed, now ill-formed</h2>
<p>Here is an example that came up while I attempted to implement these changes to measure any improvements in build time that might come up. This is a reproduction from the LLVM codebase:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">struct</span> StringRef <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">    StringRef<span class="op">(</span>std<span class="op">::</span>string <span class="kw">const</span><span class="op">&amp;)</span>; <span class="co">// NB: non-explicit</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">operator</span> std<span class="op">::</span>string<span class="op">()</span> <span class="kw">const</span>;  <span class="co">// NB: non-explicit</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="op">}</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>StringRef, StringRef<span class="op">)</span>;</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="dt">bool</span> f<span class="op">(</span>StringRef a, std<span class="op">::</span>string b<span class="op">)</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="cf">return</span> a <span class="op">==</span> b; <span class="co">// (*)</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>In C++17, the marked line is well-formed. The <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> for <code class="sourceCode cpp">basic_string</code> is a non-member function template, and so would not be considered a candidate; the only viable candidate is the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> taking two <code class="sourceCode cpp">StringRef</code>s. With the proposed changes, the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> for <code class="sourceCode cpp">basic_string</code> becomes a non-member hidden friend, <em>non-template</em>, which makes it a candidate (converting <code class="sourceCode cpp">a</code> to a <code class="sourceCode cpp">string</code>). That candidate is ambiguous with the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==(</span>StringRef, StringRef<span class="op">)</span></code> candidate - each requires a conversion in one argument, so the call becomes ill-formed.</p>
<p>Many people might consider such a type - implicitly convertible in both directions (note that <code class="sourceCode cpp">string</code> to <code class="sourceCode cpp">string_view</code> is implicit, but <code class="sourceCode cpp">string_view</code> to <code class="sourceCode cpp">string</code> is explicit) - questionable. But this is still a breaking change to consider.</p>
<h2 id="was-ill-formed-now-well-formed"><span class="header-section-number">2.2</span> <a href="#was-ill-formed-now-well-formed" class="self-link"></a>Was ill-formed, now well-formed</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1"><span class="dt">bool</span> ref_equal<span class="op">(</span>std<span class="op">::</span>reference_wrapper<span class="op">&lt;</span>std<span class="op">::</span>string<span class="op">&gt;</span> a,</a>
<a class="sourceLine" id="cb2-2" title="2">               std<span class="op">::</span>reference_wrapper<span class="op">&lt;</span>std<span class="op">::</span>string<span class="op">&gt;</span> b<span class="op">)</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="cf">return</span> a <span class="op">==</span> b;</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>The comparisons for <code class="sourceCode cpp">std<span class="op">::</span>reference_wrapper<span class="op">&lt;</span>T<span class="op">&gt;</span></code> are very strange. It’s not that this type is comparable based on <em>whether</em> <code class="sourceCode cpp">T</code> is comparable. It’s actually that this type is comparable based on <em>how</em> <code class="sourceCode cpp">T</code> is comparable. We can compare <code class="sourceCode cpp">std<span class="op">::</span>reference_wrapper<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span></code>s, but we cannot compare <code class="sourceCode cpp">std<span class="op">::</span>reference_wrapper<span class="op">&lt;</span>std<span class="op">::</span>string<span class="op">&gt;</span></code>s because the comparisons for <code class="sourceCode cpp">basic_string</code> are non-member function templates. That’s just weird. This change wouldn’t actually resolve that weirdness generally (it wouldn’t affect any user types whose comparisons are non-member function templates), but it would at least reduce it for the standard library. Arguably an improvement.</p>
<p>However, the more interesting case is:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb3-1" title="1"><span class="dt">bool</span> is42<span class="op">(</span>std<span class="op">::</span>variant<span class="op">&lt;</span><span class="dt">int</span>, std<span class="op">::</span>string<span class="op">&gt;</span> <span class="kw">const</span><span class="op">&amp;</span> v<span class="op">)</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="cf">return</span> v <span class="op">==</span> <span class="dv">42</span>; <span class="co">// (*)</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>In C++17, the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> for <code class="sourceCode cpp">variant</code> is a non-member function template and is thus not a viable candidate for the marked line. That check is ill-formed. With the proposed changes, the <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> for <code class="sourceCode cpp">variant</code> becomes a non-member hidden friend, <em>non-template</em>, which makes it a candidate (converting <code class="sourceCode cpp"><span class="dv">42</span></code> to a <code class="sourceCode cpp">variant<span class="op">&lt;</span><span class="dt">int</span>, string<span class="op">&gt;</span></code>). Many would argue that this a fix, since both <code class="sourceCode cpp">variant<span class="op">&lt;</span><span class="dt">int</span>, string<span class="op">&gt;</span> v <span class="op">=</span> <span class="dv">42</span>;</code> and <code class="sourceCode cpp">v <span class="op">=</span> <span class="dv">42</span>;</code> are already well-formed, so it is surely reasonable that <code class="sourceCode cpp">v <span class="op">==</span> <span class="dv">42</span></code> is as well.</p>
<p>But we already had a proposal to do precisely this: <span class="citation" data-cites="P1201R0">[<a href="#ref-P1201R0" role="doc-biblioref">P1201R0</a>]</span>, which failed to gain consensus in LEWGI in San Diego (vote was 2-6-2-3-3).</p>
<h2 id="alternatives"><span class="header-section-number">2.3</span> <a href="#alternatives" class="self-link"></a>Alternatives</h2>
<p>The benefit of the hidden friend technique wasn’t the only way to achieve the ultimate goal of reducing the overload candidate set. Casey Carter suggested another:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T, <span class="kw">class</span> Traits <span class="op">=</span> char_traits<span class="op">&lt;</span>T<span class="op">&gt;</span>, <span class="kw">class</span> Alloc <span class="op">=</span> allocator<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> <span class="kw">class</span> basic_string;</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">namespace</span> __foo <span class="op">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw">struct</span> __tag <span class="op">{}</span>;</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T, <span class="kw">class</span> Traits, <span class="kw">class</span> Alloc<span class="op">&gt;</span> </a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span><span class="kw">const</span> basic_string<span class="op">&lt;</span>T, Traits, Alloc<span class="op">&gt;&amp;</span>, <span class="kw">const</span> basic_string<span class="op">&lt;</span>T, Traits, Alloc<span class="op">&gt;&amp;)</span>;</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="co">/* ... */</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="op">}</span></a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T, <span class="kw">class</span> Traits, <span class="kw">class</span> Alloc<span class="op">&gt;</span> <span class="kw">class</span> basic_string <span class="op">:</span> <span class="kw">private</span> __foo<span class="op">::</span>__tag <span class="op">{</span></a>
<a class="sourceLine" id="cb4-13" title="13">  <span class="co">/* ... */</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="op">}</span>;</a></code></pre></div>
<p>That is, we keep <code class="sourceCode cpp">basic_string</code>’s comparisons as non-member function templates – but we move them into a different namespace that is <em>only</em> associated with <code class="sourceCode cpp">basic_string</code>. This is an interesting direction to take, but is novel and has some specification burden.</p>
<h2 id="proposed-direction"><span class="header-section-number">2.4</span> <a href="#proposed-direction" class="self-link"></a>Proposed Direction</h2>
<p>Ultimately, the goal here is to add <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code> to all the types in the standard library. While I think the goal of reducing the candidate set for comparisons with standard library types is absolutely worth pursuing, it is a completely orthogonal goal and can be addressed by a different proposal in the future.</p>
<p>Given that we’ve said that users aren’t allowed to take the address of most standard library functions, Casey’s proposed implementation might even be valid under today’s wording for those standard library class templates whose comparisons are non-member templates, so I’d encourage implementors to experiment there.</p>
<p>The direction this paper is taking is the path of least resistance: keep all the comparison operators as they are. Add <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code> in the same form that <code class="sourceCode cpp"><span class="op">&lt;</span></code> appears today. With a few exceptions: those types for which adding a defaulted <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">==</span></code> would allow them to be used as non-type template parameters after <span class="citation" data-cites="P0732R2">[<a href="#ref-P0732R2" role="doc-biblioref">P0732R2</a>]</span> (and only those types) will have their comparisons implemented as hidden friends.</p>
<h1 id="acknowledgements" style="border-bottom:1px solid #cccccc"><span class="header-section-number">3</span> <a href="#acknowledgements" class="self-link"></a>Acknowledgements</h1>
<p>Thank you to all the paper authors that have committed time to making sure all this works: Gašper Ažman, Walter Brown, Lawrence Crowl, Tomasz Kamiński, Arthur O’Dwyer, Jeff Snyder, David Stone, and Herb Sutter.</p>
<p>Thank you to Casey Carter for the tremendous wording review.</p>
<h1 id="wording" style="border-bottom:1px solid #cccccc"><span class="header-section-number">4</span> <a href="#wording" class="self-link"></a>Wording</h1>
<h2 id="clause-16-library-introduction"><span class="header-section-number">4.1</span> <a href="#clause-16-library-introduction" class="self-link"></a>Clause 16: Library Introduction</h2>
<p>Change 16.4.2.1/2 [expos.only.func]:</p>
<blockquote>
<p>The following <span class="rm" style="color: #bf0303"><del>function is</del></span> <span class="add" style="color: #006e28"><ins>are</ins></span> defined for exposition only to aid in the specification of the library:</p>
</blockquote>
<p>and append:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="kw">auto</span> <em>synth-3way</em> <span class="op">=</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="op">[]&lt;</span><span class="kw">class</span> T, <span class="kw">class</span> U<span class="op">&gt;(</span><span class="kw">const</span> T<span class="op">&amp;</span> t, <span class="kw">const</span> U<span class="op">&amp;</span> u<span class="op">)</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">requires</span> <span class="kw">requires</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">      <span class="op">{</span> t <span class="op">&lt;</span> u <span class="op">}</span> <span class="op">-&gt;</span> <span class="dt">bool</span>;</a>
<a class="sourceLine" id="cb1-5" title="5">      <span class="op">{</span> u <span class="op">&lt;</span> t <span class="op">}</span> <span class="op">-&gt;</span> <span class="dt">bool</span>;</a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="op">{</span></a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span>ThreeWayComparableWith<span class="op">&lt;</span>T, U<span class="op">&gt;)</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-9" title="9">      <span class="cf">return</span> t <span class="op">&lt;=&gt;</span> u;</a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-11" title="11">      <span class="cf">if</span> <span class="op">(</span>t <span class="op">&lt;</span> u<span class="op">)</span> <span class="cf">return</span> weak_ordering<span class="op">::</span>less;</a>
<a class="sourceLine" id="cb1-12" title="12">      <span class="cf">if</span> <span class="op">(</span>u <span class="op">&lt;</span> t<span class="op">)</span> <span class="cf">return</span> weak_ordering<span class="op">::</span>greater;</a>
<a class="sourceLine" id="cb1-13" title="13">      <span class="cf">return</span> weak_ordering<span class="op">::</span>equivalent;</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="op">}</span></a>
<a class="sourceLine" id="cb1-15" title="15">  <span class="op">}</span>;</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T, <span class="kw">class</span> U<span class="op">=</span>T<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">using</span> <em>synth-3way-result</em> <span class="op">=</span> <span class="kw">decltype</span><span class="op">(</span><em>synth-3way</em><span class="op">(</span>declval<span class="op">&lt;</span>T<span class="op">&amp;&gt;()</span>, declval<span class="op">&lt;</span>U<span class="op">&amp;&gt;()))</span>;</a></code></pre></div>
</blockquote>
<p>Remove all of 16.4.2.3 [operators], which begins:</p>
<blockquote>
<p><span class="rm" style="color: #bf0303"><del>In this library, whenever a declaration is provided for an <span><code class="sourceCode cpp"><span class="kw">operator</span><span class="op">!=</span></code></span>, <span><code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&gt;</span></code></span>, <span><code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=</span></code></span>, or <span><code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&gt;=</span></code></span> for a type <span><code class="sourceCode cpp">T</code></span>, its requirements and semantics are as follows, unless explicitly specified otherwise.</del></span></p>
</blockquote>
<h2 id="clause-17-language-support-library"><span class="header-section-number">4.2</span> <a href="#clause-17-language-support-library" class="self-link"></a>Clause 17: Language support library</h2>
<p>Added: <code class="sourceCode cpp">compare_three_way_result</code>, concepts <code class="sourceCode cpp">ThreeWayComparable</code> and <code class="sourceCode cpp">ThreeWayComparableWith</code>, <code class="sourceCode cpp">compare_three_way</code> and <code class="sourceCode cpp">compare_XXX_order_fallback</code></p>
<p>Changed operators for: <code class="sourceCode cpp">type_info</code></p>
<p>Respecified: <code class="sourceCode cpp">strong_order<span class="op">()</span></code>, <code class="sourceCode cpp">weak_order<span class="op">()</span></code>, and <code class="sourceCode cpp">partial_order<span class="op">()</span></code></p>
<p>Removed: <code class="sourceCode cpp">compare_3way<span class="op">()</span></code>, <code class="sourceCode cpp">strong_equal<span class="op">()</span></code>, and <code class="sourceCode cpp">weak_equal<span class="op">()</span></code></p>
<p>In 17.7.2 [type.info], remove <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">!=</span></code>:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb5"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb5-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb5-2" title="2">  class type_info {</a>
<a class="sourceLine" id="cb5-3" title="3">  public:</a>
<a class="sourceLine" id="cb5-4" title="4">    virtual ~type_info();</a>
<a class="sourceLine" id="cb5-5" title="5">    bool operator==(const type_info&amp; rhs) const noexcept;</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st">-   bool operator!=(const type_info&amp; rhs) const noexcept;</span></a>
<a class="sourceLine" id="cb5-7" title="7">    bool before(const type_info&amp; rhs) const noexcept;</a>
<a class="sourceLine" id="cb5-8" title="8">    size_t hash_code() const noexcept;</a>
<a class="sourceLine" id="cb5-9" title="9">    const char* name() const noexcept;</a>
<a class="sourceLine" id="cb5-10" title="10">    type_info(const type_info&amp; rhs) = delete; // cannot be copied</a>
<a class="sourceLine" id="cb5-11" title="11">    type_info&amp; operator=(const type_info&amp; rhs) = delete; // cannot be copied</a>
<a class="sourceLine" id="cb5-12" title="12">  };</a>
<a class="sourceLine" id="cb5-13" title="13">}</a></code></pre></div>
</div>
</blockquote>
<p>and:</p>
<blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb6-1" title="1"><span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span><span class="kw">const</span> type_info<span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">const</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">2</a></div> <em>Effects</em>: Compares the current object with <code class="sourceCode cpp">rhs</code>. <div class="marginalizedparent"><a class="marginalized">3</a></div> <em>Returns</em>: <code class="sourceCode cpp"><span class="kw">true</span></code> if the two values describe the same type.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>bool operator!=(const type_info&amp; rhs) const noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">4</a></div> <span class="rm" style="color: #bf0303"><del><em>Returns</em>: <span><code class="sourceCode cpp"><span class="op">!(*</span><span class="kw">this</span> <span class="op">==</span> rhs<span class="op">)</span></code></span>.</del></span></p>
</blockquote>
<p>Add into 17.11.1 [compare.syn]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  // [cmp.categories], comparison category types</a>
<a class="sourceLine" id="cb1-3" title="3">  class weak_equality;</a>
<a class="sourceLine" id="cb1-4" title="4">  class strong_equality;</a>
<a class="sourceLine" id="cb1-5" title="5">  class partial_ordering;</a>
<a class="sourceLine" id="cb1-6" title="6">  class weak_ordering;</a>
<a class="sourceLine" id="cb1-7" title="7">  class strong_ordering;</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">  // named comparison functions</a>
<a class="sourceLine" id="cb1-10" title="10">  constexpr bool is_eq  (weak_equality cmp) noexcept    { return cmp == 0; }</a>
<a class="sourceLine" id="cb1-11" title="11">  constexpr bool is_neq (weak_equality cmp) noexcept    { return cmp != 0; }</a>
<a class="sourceLine" id="cb1-12" title="12">  constexpr bool is_lt  (partial_ordering cmp) noexcept { return cmp &lt; 0; }</a>
<a class="sourceLine" id="cb1-13" title="13">  constexpr bool is_lteq(partial_ordering cmp) noexcept { return cmp &lt;= 0; }</a>
<a class="sourceLine" id="cb1-14" title="14">  constexpr bool is_gt  (partial_ordering cmp) noexcept { return cmp &gt; 0; }</a>
<a class="sourceLine" id="cb1-15" title="15">  constexpr bool is_gteq(partial_ordering cmp) noexcept { return cmp &gt;= 0; }</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="va">+ // common type specializations</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="va">+ template&lt;&gt; struct common_type&lt;strong_equality, partial_ordering&gt;</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="va">+   { using type = weak_equality; };</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="va">+ template&lt;&gt; struct common_type&lt;partial_ordering, strong_equality&gt;</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="va">+   { using type = weak_equality; };</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="va">+ template&lt;&gt; struct common_type&lt;strong_equality, weak_ordering&gt;</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="va">+   { using type = weak_equality; };</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="va">+ template&lt;&gt; struct common_type&lt;weak_ordering, strong_equality&gt;</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="va">+   { using type = weak_equality; };</span></a>
<a class="sourceLine" id="cb1-26" title="26"></a>
<a class="sourceLine" id="cb1-27" title="27">  // [cmp.common], common comparison category type</a>
<a class="sourceLine" id="cb1-28" title="28">  template&lt;class... Ts&gt;</a>
<a class="sourceLine" id="cb1-29" title="29">  struct common_comparison_category {</a>
<a class="sourceLine" id="cb1-30" title="30">    using type = <em>see below</em>;</a>
<a class="sourceLine" id="cb1-31" title="31">  };</a>
<a class="sourceLine" id="cb1-32" title="32">  template&lt;class... Ts&gt;</a>
<a class="sourceLine" id="cb1-33" title="33">    using common_comparison_category_t = typename common_comparison_category&lt;Ts...&gt;::type;</a>
<a class="sourceLine" id="cb1-34" title="34"></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="va">+ // [cmp.concept], concept ThreeWayComparable</span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="va">+ template&lt;class T, class Cat = partial_ordering&gt;</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="va">+   concept ThreeWayComparable = <em>see below</em>;</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="va">+ template&lt;class T, class U, class Cat = partial_ordering&gt;</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="va">+   concept ThreeWayComparableWith = <em>see below</em>;</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="va">+</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="va">+ // [cmp.result], spaceship invocation result</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="va">+ template&lt;class T, class U = T&gt; struct compare_three_way_result;</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="va">+</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="va">+ template&lt;class T, class U = T&gt;</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="va">+   using compare_three_way_result_t = typename compare_three_way_result&lt;T, U&gt;::type;</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="va">+</span></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="va">+ // [cmp.object], spaceship object</span></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="va">+ struct compare_three_way;</span></a>
<a class="sourceLine" id="cb1-49" title="49"></a>
<a class="sourceLine" id="cb1-50" title="50">  // [cmp.alg], comparison algorithms</a>
<a class="sourceLine" id="cb1-51" title="51"><span class="st">- template&lt;class T&gt; constexpr strong_ordering strong_order(const T&amp; a, const T&amp; b);</span></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="st">- template&lt;class T&gt; constexpr weak_ordering weak_order(const T&amp; a, const T&amp; b);</span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="st">- template&lt;class T&gt; constexpr partial_ordering partial_order(const T&amp; a, const T&amp; b);</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="st">- template&lt;class T&gt; constexpr strong_equality strong_equal(const T&amp; a, const T&amp; b);</span></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="st">- template&lt;class T&gt; constexpr weak_equality weak_equal(const T&amp; a, const T&amp; b);</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="va">+ inline namespace <em>unspecified</em> {</span></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="va">+   inline constexpr <em>unspecified</em> strong_order = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="va">+   inline constexpr <em>unspecified</em> weak_order = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="va">+   inline constexpr <em>unspecified</em> partial_order = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="va">+   inline constexpr <em>unspecified</em> compare_strong_order_fallback = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-61" title="61"><span class="va">+   inline constexpr <em>unspecified</em> compare_weak_order_fallback = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="va">+   inline constexpr <em>unspecified</em> compare_partial_order_fallback = <em>unspecified</em>;</span></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="va">+ }</span></a>
<a class="sourceLine" id="cb1-64" title="64">}</a></code></pre></div>
</div>
</blockquote>
<p>Change 17.11.2.2 [cmp.weakeq]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  class weak_equality {</a>
<a class="sourceLine" id="cb1-3" title="3">    int value;  // exposition only</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">    // exposition-only constructor</a>
<a class="sourceLine" id="cb1-6" title="6">    constexpr explicit weak_equality(eq v) noexcept : value(int(v)) {}  // exposition only</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8">  public:</a>
<a class="sourceLine" id="cb1-9" title="9">    // valid values</a>
<a class="sourceLine" id="cb1-10" title="10">    static const weak_equality equivalent;</a>
<a class="sourceLine" id="cb1-11" title="11">    static const weak_equality nonequivalent;</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13">    // comparisons</a>
<a class="sourceLine" id="cb1-14" title="14">    friend constexpr bool operator==(weak_equality v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">-   friend constexpr bool operator!=(weak_equality v, <em>unspecified</em>) noexcept;</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="st">-   friend constexpr bool operator==(<em>unspecified</em>, weak_equality v) noexcept;</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="st">-   friend constexpr bool operator!=(<em>unspecified</em>, weak_equality v) noexcept;</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="va">+   friend constexpr bool operator==(weak_equality v, weak_equality w) noexcept = default;</span></a>
<a class="sourceLine" id="cb1-19" title="19">    friend constexpr weak_equality operator&lt;=&gt;(weak_equality v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-20" title="20">    friend constexpr weak_equality operator&lt;=&gt;(<em>unspecified</em>, weak_equality v) noexcept;</a>
<a class="sourceLine" id="cb1-21" title="21">  };</a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23">  // valid values&#39; definitions</a>
<a class="sourceLine" id="cb1-24" title="24">  inline constexpr weak_equality weak_equality::equivalent(eq::equivalent);</a>
<a class="sourceLine" id="cb1-25" title="25">  inline constexpr weak_equality weak_equality::nonequivalent(eq::nonequivalent);</a>
<a class="sourceLine" id="cb1-26" title="26">}</a></code></pre></div>
</div>
</blockquote>
<p>and remove those functions from the description:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>weak_equality v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator==(<em>unspecified</em>, weak_equality v) noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">2</a></div> <em>Returns</em>: <code class="sourceCode cpp">v<span class="op">.</span>value <span class="op">==</span> <span class="dv">0</span></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(weak_equality v, <em>unspecified</em>) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(<em>unspecified</em>, weak_equality v) noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">3</a></div> <span class="rm" style="color: #bf0303"><del><em>Returns</em>: <span><code class="sourceCode cpp">v<span class="op">.</span>value <span class="op">!=</span> <span class="dv">0</span></code></span>.</del></span></p>
</blockquote>
<p>Change 17.11.2.3 [cmp.strongeq]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  class strong_equality {</a>
<a class="sourceLine" id="cb1-3" title="3">    int value;  // exposition only</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">    // exposition-only constructor</a>
<a class="sourceLine" id="cb1-6" title="6">    constexpr explicit strong_equality(eq v) noexcept : value(int(v)) {}    // exposition only</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8">  public:</a>
<a class="sourceLine" id="cb1-9" title="9">    // valid values</a>
<a class="sourceLine" id="cb1-10" title="10">    static const strong_equality equal;</a>
<a class="sourceLine" id="cb1-11" title="11">    static const strong_equality nonequal;</a>
<a class="sourceLine" id="cb1-12" title="12">    static const strong_equality equivalent;</a>
<a class="sourceLine" id="cb1-13" title="13">    static const strong_equality nonequivalent;</a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15">    // conversion</a>
<a class="sourceLine" id="cb1-16" title="16">    constexpr operator weak_equality() const noexcept;</a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18">    // comparisons</a>
<a class="sourceLine" id="cb1-19" title="19">    friend constexpr bool operator==(strong_equality v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-20" title="20"><span class="st">-   friend constexpr bool operator!=(strong_equality v, <em>unspecified</em>) noexcept;</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="st">-   friend constexpr bool operator==(<em>unspecified</em>, strong_equality v) noexcept;</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="st">-   friend constexpr bool operator!=(<em>unspecified</em>, strong_equality v) noexcept;</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="va">+   friend constexpr bool operator==(strong_equality v, strong_equality w) noexcept = default;  </span></a>
<a class="sourceLine" id="cb1-24" title="24">    friend constexpr strong_equality operator&lt;=&gt;(strong_equality v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-25" title="25">    friend constexpr strong_equality operator&lt;=&gt;(<em>unspecified</em>, strong_equality v) noexcept;</a>
<a class="sourceLine" id="cb1-26" title="26">  };</a>
<a class="sourceLine" id="cb1-27" title="27"></a>
<a class="sourceLine" id="cb1-28" title="28">  // valid values&#39; definitions</a>
<a class="sourceLine" id="cb1-29" title="29">  inline constexpr strong_equality strong_equality::equal(eq::equal);</a>
<a class="sourceLine" id="cb1-30" title="30">  inline constexpr strong_equality strong_equality::nonequal(eq::nonequal);</a>
<a class="sourceLine" id="cb1-31" title="31">  inline constexpr strong_equality strong_equality::equivalent(eq::equivalent);</a>
<a class="sourceLine" id="cb1-32" title="32">  inline constexpr strong_equality strong_equality::nonequivalent(eq::nonequivalent);</a>
<a class="sourceLine" id="cb1-33" title="33">}</a></code></pre></div>
</div>
</blockquote>
<p>and remove those functions from the description:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>strong_equality v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator==(<em>unspecified</em>, strong_equality v) noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">3</a></div> <em>Returns</em>: <code class="sourceCode cpp">v<span class="op">.</span>value <span class="op">==</span> <span class="dv">0</span></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(strong_equality v, <em>unspecified</em>) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(<em>unspecified</em>, strong_equality v) noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">4</a></div> <span class="rm" style="color: #bf0303"><del><em>Returns</em>: <span><code class="sourceCode cpp">v<span class="op">.</span>value <span class="op">!=</span> <span class="dv">0</span></code></span>.</del></span></p>
</blockquote>
<p>Change 17.11.2.4 [cmp.partialord]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  class partial_ordering {</a>
<a class="sourceLine" id="cb1-3" title="3">    int value;          // exposition only</a>
<a class="sourceLine" id="cb1-4" title="4">    bool is_ordered;    // exposition only</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">    [...]</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8">    // conversion</a>
<a class="sourceLine" id="cb1-9" title="9">    constexpr operator weak_equality() const noexcept;</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11">    // comparisons</a>
<a class="sourceLine" id="cb1-12" title="12">    friend constexpr bool operator==(partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="st">-   friend constexpr bool operator!=(partial_ordering v, <em>unspecified</em>) noexcept;</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="va">+   friend constexpr bool operator==(partial_ordering v, partial_ordering w) noexcept = default;</span></a>
<a class="sourceLine" id="cb1-15" title="15">    friend constexpr bool operator&lt; (partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-16" title="16">    friend constexpr bool operator&gt; (partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-17" title="17">    friend constexpr bool operator&lt;=(partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-18" title="18">    friend constexpr bool operator&gt;=(partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-19" title="19"><span class="st">-   friend constexpr bool operator==(<em>unspecified</em>, partial_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="st">-   friend constexpr bool operator!=(<em>unspecified</em>, partial_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-21" title="21">    friend constexpr bool operator&lt; (<em>unspecified</em>, partial_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-22" title="22">    friend constexpr bool operator&gt; (<em>unspecified</em>, partial_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-23" title="23">    friend constexpr bool operator&lt;=(<em>unspecified</em>, partial_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-24" title="24">    friend constexpr bool operator&gt;=(<em>unspecified</em>, partial_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-25" title="25">    friend constexpr partial_ordering operator&lt;=&gt;(partial_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-26" title="26">    friend constexpr partial_ordering operator&lt;=&gt;(<em>unspecified</em>, partial_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-27" title="27">  };</a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29">  [...]</a>
<a class="sourceLine" id="cb1-30" title="30">}</a></code></pre></div>
</div>
</blockquote>
<p>Remove just the extra <code class="sourceCode cpp"><span class="op">==</span></code> and <code class="sourceCode cpp"><span class="op">!=</span></code> operators in 17.11.2.4 [cmp.partialord]/4-5:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>partial_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span>partial_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span>partial_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span>partial_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span>partial_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">3</a></div> <em>Returns</em>: For <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>, <code class="sourceCode cpp">v<span class="op">.</span>is_ordered <span class="op">&amp;&amp;</span> v<span class="op">.</span>value <span class="er">@</span> <span class="dv">0</span></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator==(<em>unspecified</em>, partial_ordering v) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span><em>unspecified</em>, partial_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span><em>unspecified</em>, partial_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span><em>unspecified</em>, partial_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span><em>unspecified</em>, partial_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">4</a></div> <em>Returns</em>: For <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>, <code class="sourceCode cpp">v<span class="op">.</span>is_ordered <span class="op">&amp;&amp;</span> <span class="dv">0</span> <span class="er">@</span> v<span class="op">.</span>value</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(partial_ordering v, <em>unspecified</em>) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(<em>unspecified</em>, partial_ordering v) noexcept;</del></span></a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">5</a></div> <span class="rm" style="color: #bf0303"><del><em>Returns</em>: For <span><code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code></span>, <span><code class="sourceCode cpp"><span class="op">!</span>v<span class="op">.</span>is_ordered <span class="op">||</span> v<span class="op">.</span>value <span class="op">!=</span> <span class="dv">0</span></code></span>.</del></span></p>
</blockquote>
<p>Change 17.11.2.5 [cmp.weakord]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  class weak_ordering {</a>
<a class="sourceLine" id="cb1-3" title="3">    int value;  // exposition only</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">    [...]</a>
<a class="sourceLine" id="cb1-6" title="6">    // comparisons</a>
<a class="sourceLine" id="cb1-7" title="7">    friend constexpr bool operator==(weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="va">+   friend constexpr bool operator==(weak_ordering v, weak_ordering w) noexcept = default;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="st">-   friend constexpr bool operator!=(weak_ordering v, <em>unspecified</em>) noexcept;</span></a>
<a class="sourceLine" id="cb1-10" title="10">    friend constexpr bool operator&lt; (weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-11" title="11">    friend constexpr bool operator&gt; (weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-12" title="12">    friend constexpr bool operator&lt;=(weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-13" title="13">    friend constexpr bool operator&gt;=(weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="st">-   friend constexpr bool operator==(<em>unspecified</em>, weak_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">-   friend constexpr bool operator!=(<em>unspecified</em>, weak_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-16" title="16">    friend constexpr bool operator&lt; (<em>unspecified</em>, weak_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-17" title="17">    friend constexpr bool operator&gt; (<em>unspecified</em>, weak_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-18" title="18">    friend constexpr bool operator&lt;=(<em>unspecified</em>, weak_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-19" title="19">    friend constexpr bool operator&gt;=(<em>unspecified</em>, weak_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-20" title="20">    friend constexpr weak_ordering operator&lt;=&gt;(weak_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-21" title="21">    friend constexpr weak_ordering operator&lt;=&gt;(<em>unspecified</em>, weak_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-22" title="22">  };</a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24">  [...]</a>
<a class="sourceLine" id="cb1-25" title="25">}</a></code></pre></div>
</div>
</blockquote>
<p>Remove just the extra <code class="sourceCode cpp"><span class="op">==</span></code> and <code class="sourceCode cpp"><span class="op">!=</span></code> operators from 17.11.2.5 [cmp.weakord]/4 and /5:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>weak_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(weak_ordering v, <em>unspecified</em>) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span>weak_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span>weak_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span>weak_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span>weak_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">4</a></div> <em>Returns</em>: <code class="sourceCode cpp">v<span class="op">.</span>value <span class="er">@</span> <span class="dv">0</span></code> for <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator==(<em>unspecified</em>, weak_ordering v) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(<em>unspecified</em>, weak_ordering v) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span><em>unspecified</em>, weak_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span><em>unspecified</em>, weak_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span><em>unspecified</em>, weak_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span><em>unspecified</em>, weak_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">5</a></div> <em>Returns</em>: <code class="sourceCode cpp"><span class="dv">0</span> <span class="er">@</span> v<span class="op">.</span>value</code> for <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>.</p>
</blockquote>
<p>Change 17.11.2.6 [cmp.strongord]:</p>
<blockquote>
<div>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">namespace std {</a>
<a class="sourceLine" id="cb1-2" title="2">  class strong_ordering {</a>
<a class="sourceLine" id="cb1-3" title="3">    int value;  // exposition only</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">    [...]</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">    // comparisons</a>
<a class="sourceLine" id="cb1-8" title="8">    friend constexpr bool operator==(strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="va">+   friend constexpr bool operator==(strong_ordering v, strong_ordering w) noexcept = default;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="st">-   friend constexpr bool operator!=(strong_ordering v, <em>unspecified</em>) noexcept;</span></a>
<a class="sourceLine" id="cb1-11" title="11">    friend constexpr bool operator&lt; (strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-12" title="12">    friend constexpr bool operator&gt; (strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-13" title="13">    friend constexpr bool operator&lt;=(strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-14" title="14">    friend constexpr bool operator&gt;=(strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">-   friend constexpr bool operator==(<em>unspecified</em>, strong_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="st">-   friend constexpr bool operator!=(<em>unspecified</em>, strong_ordering v) noexcept;</span></a>
<a class="sourceLine" id="cb1-17" title="17">    friend constexpr bool operator&lt; (<em>unspecified</em>, strong_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-18" title="18">    friend constexpr bool operator&gt; (<em>unspecified</em>, strong_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-19" title="19">    friend constexpr bool operator&lt;=(<em>unspecified</em>, strong_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-20" title="20">    friend constexpr bool operator&gt;=(<em>unspecified</em>, strong_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-21" title="21">    friend constexpr strong_ordering operator&lt;=&gt;(strong_ordering v, <em>unspecified</em>) noexcept;</a>
<a class="sourceLine" id="cb1-22" title="22">    friend constexpr strong_ordering operator&lt;=&gt;(<em>unspecified</em>, strong_ordering v) noexcept;</a>
<a class="sourceLine" id="cb1-23" title="23">  };</a>
<a class="sourceLine" id="cb1-24" title="24"></a>
<a class="sourceLine" id="cb1-25" title="25">  [...]</a>
<a class="sourceLine" id="cb1-26" title="26">}</a></code></pre></div>
</div>
</blockquote>
<p>Remove just the extra <code class="sourceCode cpp"><span class="op">==</span></code> and <code class="sourceCode cpp"><span class="op">!=</span></code> operators from 17.11.2.6 [cmp.strongord]/6 and /7:</p>
<blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>strong_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(strong_ordering v, <em>unspecified</em>) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span>strong_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span>strong_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span>strong_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span>strong_ordering v, <em>unspecified</em><span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">6</a></div> <em>Returns</em>: <code class="sourceCode cpp">v<span class="op">.</span>value <span class="er">@</span> <span class="dv">0</span></code> for <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="rm" style="color: #bf0303"><del>constexpr bool operator==(<em>unspecified</em>, strong_ordering v) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="rm" style="color: #bf0303"><del>constexpr bool operator!=(<em>unspecified</em>, strong_ordering v) noexcept;</del></span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;</span> <span class="op">(</span><em>unspecified</em>, strong_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;</span> <span class="op">(</span><em>unspecified</em>, strong_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span><em>unspecified</em>, strong_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;=(</span><em>unspecified</em>, strong_ordering v<span class="op">)</span> <span class="kw">noexcept</span>;</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">7</a></div> <em>Returns</em>: <code class="sourceCode cpp"><span class="dv">0</span> <span class="er">@</span> v<span class="op">.</span>value</code> for <code class="sourceCode cpp"><span class="kw">operator</span><span class="er">@</span></code>.</p>
</blockquote>
<p>Add a new subclause [cmp.concept] “concept ThreeWayComparable”:</p>
<blockquote>
<div class="add" style="color: #006e28">

<div class="sourceCode" id="cb1"><pre class="sourceCode default"><code class="sourceCode default"><a class="sourceLine" id="cb1-1" title="1">template &lt;typename T, typename Cat&gt;</a>
<a class="sourceLine" id="cb1-2" title="2">  concept <em>compares-as</em> = // exposition only</a>
<a class="sourceLine" id="cb1-3" title="3">    Same&lt;common_comparison_category_t&lt;T, Cat&gt;, Cat&gt;;</a></code></pre></div>
<div class="sourceCode" id="cb1"><pre class="sourceCode default"><code class="sourceCode default"><a class="sourceLine" id="cb1-1" title="1">template&lt;class T, class U&gt;</a>
<a class="sourceLine" id="cb1-2" title="2">  concept <em>partially-ordered-with</em> = // exposition only</a>
<a class="sourceLine" id="cb1-3" title="3">    requires(const remove_reference_t&lt;T&gt;&amp; t,</a>
<a class="sourceLine" id="cb1-4" title="4">             const remove_reference_t&lt;U&gt;&amp; u) {</a>
<a class="sourceLine" id="cb1-5" title="5">      { t &lt; u } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-6" title="6">      { t &gt; u } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-7" title="7">      { t &lt;= u } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-8" title="8">      { t &gt;= u } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-9" title="9">      { u &lt; t } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-10" title="10">      { u &gt; t } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-11" title="11">      { u &lt;= t } -&gt; Boolean;</a>
<a class="sourceLine" id="cb1-12" title="12">      { u &gt;= t } -&gt; Boolean;    </a>
<a class="sourceLine" id="cb1-13" title="13">    };</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">1</a></div> Let <code class="sourceCode cpp">t</code> and <code class="sourceCode cpp">u</code> be lvalues of types <code class="sourceCode cpp"><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>T<span class="op">&gt;</span></code> and <code class="sourceCode cpp"><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>U<span class="op">&gt;</span></code> respectively. <em><code class="sourceCode cpp">partially<span class="op">-</span>ordered<span class="op">-</span>with</code></em><code class="sourceCode cpp"><span class="op">&lt;</span>T, U<span class="op">&gt;</span></code> is satisfied only if:</p>
<ul>
<li><div class="marginalizedparent"><a class="marginalized">(1.1)</a></div> <code class="sourceCode cpp">t <span class="op">&lt;</span> u</code>, <code class="sourceCode cpp">t <span class="op">&lt;=</span> u</code>, <code class="sourceCode cpp">t <span class="op">&gt;</span> u</code>, <code class="sourceCode cpp">t <span class="op">&gt;=</span> u</code>, <code class="sourceCode cpp">u <span class="op">&lt;</span> t</code>, <code class="sourceCode cpp">u <span class="op">&lt;=</span> t</code>, <code class="sourceCode cpp">u <span class="op">&gt;</span> t</code>, and <code class="sourceCode cpp">u <span class="op">&gt;=</span> t</code> have the same domain.</li>
<li><div class="marginalizedparent"><a class="marginalized">(1.2)</a></div> <code class="sourceCode cpp"><span class="dt">bool</span><span class="op">(</span>t <span class="op">&lt;</span> u<span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>u <span class="op">&gt;</span> t<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(1.3)</a></div> <code class="sourceCode cpp"><span class="dt">bool</span><span class="op">(</span>u <span class="op">&lt;</span> t<span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&gt;</span> u<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(1.4)</a></div> <code class="sourceCode cpp"><span class="dt">bool</span><span class="op">(</span>t <span class="op">&lt;=</span> u<span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>u <span class="op">&gt;=</span> t<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(1.5)</a></div> <code class="sourceCode cpp"><span class="dt">bool</span><span class="op">(</span>u <span class="op">&lt;=</span> t<span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&gt;=</span> u<span class="op">)</span></code></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode default"><code class="sourceCode default"><a class="sourceLine" id="cb1-1" title="1">template &lt;typename T, typename Cat = partial_ordering&gt;</a>
<a class="sourceLine" id="cb1-2" title="2">  concept ThreeWayComparable =</a>
<a class="sourceLine" id="cb1-3" title="3">    <em>weakly-equality-comparable-with</em>&lt;T, T&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-4" title="4">    (!ConvertibleTo&lt;Cat, partial_ordering&gt; || <em>partially-ordered-with</em>&lt;T, T&gt;) &amp;&amp;</a>
<a class="sourceLine" id="cb1-5" title="5">    requires(const remove_reference_t&lt;T&gt;&amp; a,</a>
<a class="sourceLine" id="cb1-6" title="6">             const remove_reference_t&lt;T&gt;&amp; b) {</a>
<a class="sourceLine" id="cb1-7" title="7">      { a &lt;=&gt; b } -&gt; <em>compares-as</em>&lt;Cat&gt;;</a>
<a class="sourceLine" id="cb1-8" title="8">    };</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">2</a></div> Let <code class="sourceCode cpp">a</code> and <code class="sourceCode cpp">b</code> be lvalues of type <code class="sourceCode cpp"><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>T<span class="op">&gt;</span></code>. <code class="sourceCode cpp">T</code> and <code class="sourceCode cpp">Cat</code> model <code class="sourceCode cpp">ThreeWayComparable<span class="op">&lt;</span>T, Cat<span class="op">&gt;</span></code> only if:</p>
<ul>
<li><div class="marginalizedparent"><a class="marginalized">(2.1)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">==</span> b<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.2)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">!=</span> b<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.3)</a></div> <code class="sourceCode cpp"><span class="op">((</span>a <span class="op">&lt;=&gt;</span> b<span class="op">)</span> <span class="op">&lt;=&gt;</span> <span class="dv">0</span><span class="op">)</span></code> and <code class="sourceCode cpp"><span class="op">(</span><span class="dv">0</span> <span class="op">&lt;=&gt;</span> <span class="op">(</span>b <span class="op">&lt;=&gt;</span> a<span class="op">))</span></code> are equal</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.4)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">strong_equality</code>, <code class="sourceCode cpp">T</code> models <code class="sourceCode cpp">EqualityComparable</code> ([concept.equalitycomparable]).</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.5)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">partial_ordering</code>:
<ul>
<li><div class="marginalizedparent"><a class="marginalized">(2.5.1)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">&lt;</span> b<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.5.2)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">&gt;</span> b<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.5.3)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">&lt;=</span> b<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(2.5.4)</a></div> <code class="sourceCode cpp"><span class="op">(</span>a <span class="op">&lt;=&gt;</span> b <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>a <span class="op">&gt;=</span> b<span class="op">)</span></code>.</li>
</ul></li>
<li><div class="marginalizedparent"><a class="marginalized">(2.5.5)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">strong_ordering</code>, <code class="sourceCode cpp">T</code> models <code class="sourceCode cpp">StrictTotallyOrdered</code> ([concept.stricttotallyordered]).</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode default"><code class="sourceCode default"><a class="sourceLine" id="cb1-1" title="1">template &lt;typename T, typename U,</a>
<a class="sourceLine" id="cb1-2" title="2">          typename Cat = partial_ordering&gt;</a>
<a class="sourceLine" id="cb1-3" title="3">  concept ThreeWayComparableWith = </a>
<a class="sourceLine" id="cb1-4" title="4">    <em>weakly-equality-comparable-with</em>&lt;T, U&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-5" title="5">    (!ConvertibleTo&lt;Cat, partial_ordering&gt; || <em>partially-ordered-with</em>&lt;T, U&gt;) &amp;&amp;</a>
<a class="sourceLine" id="cb1-6" title="6">    ThreeWayComparable&lt;T, Cat&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-7" title="7">    ThreeWayComparable&lt;U, Cat&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-8" title="8">    CommonReference&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-9" title="9">    ThreeWayComparable&lt;</a>
<a class="sourceLine" id="cb1-10" title="10">      common_reference_t&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt;,</a>
<a class="sourceLine" id="cb1-11" title="11">      Cat&gt; &amp;&amp;</a>
<a class="sourceLine" id="cb1-12" title="12">    requires(const remove_reference_t&lt;T&gt;&amp; t,</a>
<a class="sourceLine" id="cb1-13" title="13">             const remove_reference_t&lt;U&gt;&amp; u) {</a>
<a class="sourceLine" id="cb1-14" title="14">      { t &lt;=&gt; u } -&gt; <em>compares-as</em>&lt;Cat&gt;;</a>
<a class="sourceLine" id="cb1-15" title="15">      { u &lt;=&gt; t } -&gt; <em>compares-as</em>&lt;Cat&gt;;</a>
<a class="sourceLine" id="cb1-16" title="16">    };</a></code></pre></div>
<p><div class="marginalizedparent"><a class="marginalized">3</a></div> Let <code class="sourceCode cpp">t</code> and <code class="sourceCode cpp">u</code> be lvalues of types <code class="sourceCode cpp"><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>T<span class="op">&gt;</span></code> and <code class="sourceCode cpp"><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>U<span class="op">&gt;</span></code>, respectively. Let <code class="sourceCode cpp">C</code> be <code class="sourceCode cpp">common_reference_t<span class="op">&lt;</span><span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>T<span class="op">&gt;&amp;</span>, <span class="kw">const</span> remove_reference_t<span class="op">&lt;</span>U<span class="op">&gt;&amp;&gt;</span></code>. <code class="sourceCode cpp">T</code>, <code class="sourceCode cpp">U</code>, and <code class="sourceCode cpp">Cat</code> model <code class="sourceCode cpp">ThreeWayComparableWith<span class="op">&lt;</span>T, U, Cat<span class="op">&gt;</span></code> only if:</p>
<ul>
<li><div class="marginalizedparent"><a class="marginalized">(3.1)</a></div> <code class="sourceCode cpp">t <span class="op">&lt;=&gt;</span> u</code> and <code class="sourceCode cpp">u <span class="op">&lt;=&gt;</span> t</code> have the same domain.</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.2)</a></div> <code class="sourceCode cpp"><span class="op">((</span>t <span class="op">&lt;=&gt;</span> u<span class="op">)</span> <span class="op">&lt;=&gt;</span> <span class="dv">0</span><span class="op">)</span></code> and <code class="sourceCode cpp"><span class="op">(</span><span class="dv">0</span> <span class="op">&lt;=&gt;</span> <span class="op">(</span>u <span class="op">&lt;=&gt;</span> t<span class="op">))</span></code> are equal</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.3)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">==</span> u<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.4)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">!=</span> u<span class="op">)</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.5)</a></div> <code class="sourceCode cpp">Cat<span class="op">(</span>t <span class="op">&lt;=&gt;</span> u<span class="op">)</span> <span class="op">==</span> Cat<span class="op">(</span>C<span class="op">(</span>t<span class="op">)</span> <span class="op">&lt;=&gt;</span> C<span class="op">(</span>u<span class="op">))</span></code>.</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.6)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">strong_equality</code>, <code class="sourceCode cpp">T</code> and <code class="sourceCode cpp">U</code> model <code class="sourceCode cpp">EqualityComparableWith<span class="op">&lt;</span>T, U<span class="op">&gt;</span></code> ([concepts.equalitycomparable]).</li>
<li><div class="marginalizedparent"><a class="marginalized">(3.7)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">partial_ordering</code>:
<ul>
<li><div class="marginalizedparent"><a class="marginalized">(3.7.1)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&lt;</span> u<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(3.7.2)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&gt;</span> u<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(3.7.3)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&lt;=</span> u<span class="op">)</span></code></li>
<li><div class="marginalizedparent"><a class="marginalized">(3.7.4)</a></div> <code class="sourceCode cpp"><span class="op">(</span>t <span class="op">&lt;=&gt;</span> u <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dt">bool</span><span class="op">(</span>t <span class="op">&gt;=</span> u<span class="op">)</span></code></li>
</ul></li>
<li><div class="marginalizedparent"><a class="marginalized">(3.8)</a></div> If <code class="sourceCode cpp">Cat</code> is convertible to <code class="sourceCode cpp">strong_ordering</code>, <code class="sourceCode cpp">T</code> and <code class="sourceCode cpp">U</code> model <code class="sourceCode cpp">StrictTotallyOrderedWith<span class="op">&lt;</span>T, U<span class="op">&gt;</span></code> ([concepts.stricttotallyordered]).</li>
</ul>

</div>
</blockquote>
<h1 id="references" style="border-bottom:1px solid #cccccc"><span class="header-section-number">5</span> <a href="#references" class="self-link"></a>References</h1>

<div id="refs" role="doc-bibliography">
<div id="ref-P0732R2">
<p>[P0732R2] Jeff Snyder, Louis Dionne. 2018. Class Types in Non-Type Template Parameters. <br />
<a href="https://wg21.link/p0732r2">https://wg21.link/p0732r2</a></p>
</div>
<div id="ref-P0790R2">
<p>[P0790R2] David Stone. 2019. Effect of operator&lt;=&gt; on the C++ Standard Library. <br />
<a href="https://wg21.link/p0790r2">https://wg21.link/p0790r2</a></p>
</div>
<div id="ref-P0891R2">
<p>[P0891R2] Gašper Ažman, Jeff Snyder. 2019. Make <code class="sourceCode cpp">strong_order</code> a Customization Point! <br />
<a href="https://wg21.link/p0891r2">https://wg21.link/p0891r2</a></p>
</div>
<div id="ref-P1154R1">
<p>[P1154R1] Arthur O’Dwyer, Jeff Snyder. 2019. Type traits for structural comparison. <br />
<a href="https://wg21.link/p1154r1">https://wg21.link/p1154r1</a></p>
</div>
<div id="ref-P1185R2">
<p>[P1185R2] Barry Revzin. 2019. <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span> <span class="op">!=</span> <span class="op">==</span></code>. <br />
<a href="https://wg21.link/p1185r2">https://wg21.link/p1185r2</a></p>
</div>
<div id="ref-P1186R1">
<p>[P1186R1] Barry Revzin. 2019. When do you actually use <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code>? <br />
<a href="https://wg21.link/p1186r1">https://wg21.link/p1186r1</a></p>
</div>
<div id="ref-P1188R0">
<p>[P1188R0] Barry Revzin. 2019. Library utilities for <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code>. <br />
<a href="https://wg21.link/p1188r0">https://wg21.link/p1188r0</a></p>
</div>
<div id="ref-P1189R0">
<p>[P1189R0] Barry Revzin. 2019. Adding <code class="sourceCode cpp"><span class="op">&lt;=&gt;</span></code> to library. <br />
<a href="https://wg21.link/p1189r0">https://wg21.link/p1189r0</a></p>
</div>
<div id="ref-P1191R0">
<p>[P1191R0] David Stone. 2018. Adding <code class="sourceCode cpp"><span class="kw">operator</span><span class="op">&lt;=&gt;</span></code> to types that are not currently comparable. <br />
<a href="https://wg21.link/p1191r0">https://wg21.link/p1191r0</a></p>
</div>
<div id="ref-P1201R0">
<p>[P1201R0] Oleg Fatkhiev, Antony Polukhin. 2018. Variant direct comparisons. <br />
<a href="https://wg21.link/p1201r0">https://wg21.link/p1201r0</a></p>
</div>
<div id="ref-P1295R0">
<p>[P1295R0] Tomasz Kamiński. 2018. Spaceship library update. <br />
<a href="https://wg21.link/p1295r0">https://wg21.link/p1295r0</a></p>
</div>
<div id="ref-P1380R1">
<p>[P1380R1] Lawrence Crowl. 2019. Ambiguity and Insecurities with Three-Way Comparison. <br />
<a href="https://wg21.link/p1380r1">https://wg21.link/p1380r1</a></p>
</div>
</div>
</div>
</div>
</body>
</html>
